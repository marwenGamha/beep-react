{"version":3,"sources":["../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js","views/Admin/ResetPassword/index.js"],"names":["_createForOfIteratorHelper","o","allowArrayLike","it","Symbol","iterator","Array","isArray","length","i","F","s","n","done","value","e","_e","f","TypeError","err","normalCompletion","didErr","step","next","_e2","LoginPage","useState","message","setMessage","messageType","setMessageType","loading","setLoading","token","setToken","canUpdate","setCanUpdate","params","useParams","resetPasswordLogic","a","preventDefault","resetPasswordForm","document","querySelector","formData","FormData","tmp","values","push","data","JSON","stringify","newPassword1","shift","newPassword2","axios","url","method","headers","Authorization","then","res","reset","test","m","split","pop","b","slice","success","catch","msg","request","response","parse","useEffect","_mailToken","fetchData","className","alt","src","to","onSubmit","type","placeholder","name","required","disabled","routes","adminForgotPassword","adminLoginPage"],"mappings":"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","file":"static/js/13.98b0dde5.chunk.js","sourcesContent":["import unsupportedIterableToArray from \"@babel/runtime/helpers/esm/unsupportedIterableToArray\";\nexport default function _createForOfIteratorHelper(o, allowArrayLike) {\n  var it;\n\n  if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) {\n    if (Array.isArray(o) || (it = unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n\n      var F = function F() {};\n\n      return {\n        s: F,\n        n: function n() {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function e(_e) {\n          throw _e;\n        },\n        f: F\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var normalCompletion = true,\n      didErr = false,\n      err;\n  return {\n    s: function s() {\n      it = o[Symbol.iterator]();\n    },\n    n: function n() {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function e(_e2) {\n      didErr = true;\n      err = _e2;\n    },\n    f: function f() {\n      try {\n        if (!normalCompletion && it[\"return\"] != null) it[\"return\"]();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}","import axios from \"axios\";\nimport { useEffect, useState } from \"react\";\nimport { Link, useParams } from \"react-router-dom\";\nimport routes from \"../../../routes/restaurant\";\n\nimport \"./reset-password.css\";\n\nconst LoginPage = () => {\n  const [message, setMessage] = useState(\"\");\n  const [messageType, setMessageType] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [token, setToken] = useState(null);\n  const [canUpdate, setCanUpdate] = useState(true);\n\tconst params=useParams();\n\n  const resetPasswordLogic = async (e) => {\n    e.preventDefault();\n    setLoading(true);\n    setMessage(\"\");\n    const resetPasswordForm = document.querySelector(\"form\");\n    const formData = new FormData(resetPasswordForm);\n\n    const tmp = [];\n    for (var value of formData.values()) tmp.push(value);\n\n    const data = JSON.stringify({\n      newPassword1: tmp.shift(),\n      newPassword2: tmp.shift(),\n    });\n\n    await axios({\n      url: \"/api/restaurant/resetPassword\",\n      method: \"POST\",\n      data,\n      headers: {\n        Authorization: `auth-token:${token}`,\n        \"Content-Type\": \"application/json\",\n      },\n    })\n      .then((res) => {\n        resetPasswordForm.reset();\n        setMessage(res.data.message);\n\n        if (/`/.test(res.data.message)) {\n          var m = res.data.message.split(\"`\");\n          var a = m.pop();\n          var b = m.pop();\n\n          setMessage(`New passwords length (${b.length}) ${a.slice(2)}`);\n        }\n        setMessageType(res.data.success ? \"ok\" : \"ko\");\n        setLoading(false);\n        setCanUpdate(false);\n      })\n      .catch((e) => {\n        resetPasswordForm.reset();\n        const msg = e?.request?.response\n          ? JSON.parse(e.request.response).message\n          : e.message;\n        setMessage(msg);\n        setMessageType(\"ko\");\n        setLoading(false);\n      });\n  };\n\n  useEffect(() => {\n    const mailToken = params.token;\n\n    async function fetchData(_mailToken) {\n      setLoading(true);\n\n      await axios({\n        url: \"/api/restaurant/verify-forgotPassword\",\n        method: \"POST\",\n        headers: {\n          Authorization: `auth-token:${_mailToken}`,\n          \"Content-Type\": \"application/json\",\n        },\n      })\n        .then((res) => {\n          setToken(res?.data?.token);\n          setMessage(res?.data?.message);\n          setMessageType(res?.data?.success ? \"ok\" : \"ko\");\n          res?.data?.success === false && setCanUpdate(false);\n          setLoading(false);\n        })\n        .catch((e) => {\n          const msg = e?.request?.response\n            ? JSON.parse(e.request.response).message\n            : e.message;\n          setMessage(msg);\n          setMessageType(\"ko\");\n          setCanUpdate(false);\n          setLoading(false);\n        });\n    }\n\n    fetchData(mailToken);\n  }, [params]);\n\n  return (\n    <>\n      <div className=\"resetPassword-container\">\n        <div className=\"container-left\">\n          <img alt=\"loading\" src=\"../img/login3.jpg\" />\n        </div>\n        <div className=\"container-right\">\n          {loading ? (\n            <div className=\"container-loader\">\n              <div className=\"loader\"></div>\n            </div>\n          ) : (\n            <div className=\"login\">\n              <Link to=\"/\">\n                <img alt=\"loading\" src=\"../img/Group73.png\"></img>\n              </Link>\n              {canUpdate === true ? (\n                <>\n                  <div className=\"login-title\">Modifier votre mot de passe</div>\n                  <form onSubmit={resetPasswordLogic}>\n                    <input\n                      type=\"password\"\n                      placeholder=\"Nouveau mot de passe\"\n                      name=\"new-password1\"\n                      required\n                    ></input>\n                    <input\n                      type=\"password\"\n                      placeholder=\"VÃ©rifier le nouveau mot de passe\"\n                      name=\"new-password2\"\n                      required\n                    ></input>\n                    {message && (\n                      <div className={\"alert-message \" + messageType}>\n                        {message}\n                      </div>\n                    )}\n                    <button\n                      type=\"submit\"\n                      disabled={loading}\n                      className=\"btn btn-submit\"\n                    >\n                      Modifier\n                    </button>\n                  </form>\n                </>\n              ) : (\n                message && (\n                  <>\n                    <div className={\"alert-message \" + messageType}>\n                      {message}\n                    </div>\n                    {messageType === \"ko\" ? (\n                      <Link\n                        className=\"login-link\"\n                        to={routes.adminForgotPassword}\n                      >\n                        Envoyer un autre Email ?\n                      </Link>\n                    ) : (\n                      <Link className=\"login-link\" to={routes.adminLoginPage}>\n                        Page de connexion ?\n                      </Link>\n                    )}\n                  </>\n                )\n              )}\n            </div>\n          )}\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default LoginPage;\n"],"sourceRoot":""}