(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{137:function(e,t,n){},138:function(e,t,n){},139:function(e,t){},140:function(e,t){},141:function(e,t){},142:function(e,t){},143:function(e,t){},145:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(45),i=n.n(r),s=n(22),o=n(7),u=(n(82),n(13)),l=n(6),d=n(32),b=n(5),p=n(2),j=["component","restricted"],m=function(e){var t=e.component,n=e.restricted,c=Object(d.a)(e,j),r=Object(a.useState)(!1),i=Object(l.a)(r,2),s=i[0],m=i[1],O=Object(a.useState)(),f=Object(l.a)(O,2),g=f[0],h=f[1],x={admin:b.a.adminHomePage,superAdmin:b.a.superAdminHomePage};return Object(a.useEffect)((function(){var e=localStorage.getItem("token"),t=localStorage.getItem("admin-token");e?(h(e),m("admin")):t&&(h(t),m("superAdmin"))}),[]),Object(p.jsx)(o.b,Object(u.a)(Object(u.a)({},c),{},{render:function(e){return g&&n?Object(p.jsx)(o.a,{to:x[s]}):Object(p.jsx)(t,Object(u.a)(Object(u.a)({},e),{},{type:c.type}))}}))},O=n(4),f=n.n(O),g=n(8),h=n(20),x=n.n(h),v=["component"],w=function(e){var t=e.component,n=Object(d.a)(e,v),c=Object(a.useState)(!0),r=Object(l.a)(c,2),i=r[0],s=r[1],j=Object(a.useState)(!1),m=Object(l.a)(j,2),O=m[0],h=m[1],w=Object(a.useState)(!1),A=Object(l.a)(w,2),y=A[0],S=A[1],k={admin:b.a.adminHomePage,superAdmin:b.a.superAdminHomePage},P=function(){var e=Object(g.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x()({url:localStorage.getItem("admin-token")?"/api/admin/connect":"/api/restaurant/admin/connect",method:"GET",headers:{Authorization:"auth-token:".concat(t),"Content-Type":"application/json"}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){var e=localStorage.getItem("token"),t=localStorage.getItem("admin-token");e?S("admin"):t&&S("superAdmin");var n=e||t;if(n){var a=function(){var e=Object(g.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(n).then((function(e){!1===e.data.success?(h(!1),localStorage.removeItem("token"),localStorage.removeItem("admin-token")):h(!0),s(!1)})).catch((function(e){}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();a()}else s(!1),h(!1)}),[]),Object(p.jsx)(o.b,Object(u.a)(Object(u.a)({},n),{},{render:function(e){return i?Object(p.jsx)(p.Fragment,{}):O?n.requiredRole===y?Object(p.jsx)(t,Object(u.a)({},e)):Object(p.jsx)(o.a,{to:{pathname:k[y],state:{from:e.location}}}):Object(p.jsx)(o.a,{to:{pathname:"admin"===n.requiredRole?b.a.adminLoginPage:b.a.superAdminLoginPage,search:n.path.toLowerCase()===e.location.pathname.toLowerCase()&&"?next=".concat(n.path),state:{from:e.location}}})}}))},A=(n(55),function(e){var t=e.beep;return Object(p.jsx)("div",{className:"beep-details",children:Object(p.jsxs)("div",{className:"beep-generated",style:t.ready?{background:"green"}:{},children:[Object(p.jsx)("div",{className:"beep-img-container",children:Object(p.jsx)("img",{src:"../../../img/beep_logo.png",alt:"loading..."})}),Object(p.jsxs)("div",{className:"content",children:[Object(p.jsxs)("div",{className:"beep-head",children:[Object(p.jsx)("img",{src:"../../../img/beep_badge.png",alt:"loading..."}),Object(p.jsx)("div",{className:"badge-text",children:"Code g\xe9n\xe9r\xe9 avec succ\xe8s"})]}),Object(p.jsxs)("div",{className:"separation",children:[Object(p.jsx)("div",{className:"circle-1"}),Object(p.jsx)("div",{className:"circle-2"})]}),Object(p.jsxs)("div",{className:"beep-body",children:[Object(p.jsx)("div",{className:"beep-body-title",children:"Votre num\xe9ro est"}),Object(p.jsxs)("div",{className:"beep-details-number",children:["N\xb0",t.numero]}),t.ready&&Object(p.jsx)("div",{className:"beep-body-ready",children:"Pr\xe9sentez-vous au comptoire"}),Object(p.jsx)("div",{children:" "}),Object(p.jsx)("div",{className:"beep-body-generate-time beep-body-title",children:"(ticket bleu= En cours/ticket vert=C'est pr\xeat)"}),Object(p.jsx)("div",{className:"beep-bottom-effect"})]})]})]})})}),y=n(59),S=function(e){var t=e.setBeepToken,n=e.restaurantId,c=(e.setShowBepp,Object(a.useState)(!1)),r=Object(l.a)(c,2),i=r[0],s=r[1],o=function(){var e=Object(g.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(!0),e.next=3,Object(y.a)(n).then((function(e){s(!1),localStorage.setItem("beepToken",e),t(e)})).catch((function(e){}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(p.jsx)("button",{className:"btn-submit btn text",disabled:i,onClick:o,children:"G\xe9n\xe9rer un beep"})},k=n(30),P=n.n(k),N=n(76),R=n.n(N),I=(n(137),n(29),function(){var e=Object(o.i)().restaurantId,t=Object(a.useState)(""),n=Object(l.a)(t,2),c=n[0],r=n[1],i=Object(a.useState)(null),u=Object(l.a)(i,2),d=u[0],b=u[1],j=Object(a.useState)(!1),m=Object(l.a)(j,2),O=m[0],h=m[1],v=Object(a.useState)(localStorage.getItem("beepToken")||null),w=Object(l.a)(v,2),y=w[0],k=w[1],N=Object(a.useRef)();window.OneSignal=window.OneSignal||[];var I=window.OneSignal;Object(a.useEffect)((function(){I.push((function(){I.init({appId:"d5ac5184-7776-4e38-b5bd-6ae8aa57fa95",safari_web_id:"web.onesignal.auto.3b9e77c1-5852-4edd-a278-c29c156a72b0",notifyButton:{enable:!0},welcomeNotification:{title:"One Signal",message:"Thanks for subscribing!"}})}))}),[]),Object(a.useEffect)((function(){C(),N.current&&N.current.offAny(),y&&(N.current=P()("/"),N.current.emit("auth",{beepToken:y}),N.current.on("auth",(function(e){e.success?(b(e.beep),h(!0)):(k(null),localStorage.removeItem("beepToken"))})),N.current.on("getUpdate",(function(e){var t=e.beep;switch(e.change){case"delete":localStorage.removeItem("beepToken"),b(null),k(null),h(!1);break;case"call":console.log("test"),b(t),R()({title:"Notification",subtitle:"This is a subtitle",message:"votre commande est pr\xeate",theme:"darkblue",vibrate:!0,native:!0});break;default:b(t)}})))}),[y]);var C=function(){var t=Object(g.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x()({url:"/api/restaurant/".concat(e),method:"GET",headers:{"Content-Type":"application/json"}}).then(function(){var e=Object(g.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.data&&(r(t.data.data[0].imageURL),localStorage.setItem("user",JSON.stringify(t.data.data[0])));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return setTimeout("window.location.reload();",3e4),Object(p.jsxs)("div",{className:"beep-client",children:[!O&&Object(p.jsx)("div",{className:"beep-client-container",children:Object(p.jsxs)("div",{className:"beep-client-sub-container",children:[Object(p.jsx)("img",{alt:"loading",src:"/api/restaurant/serveimg/"+c}),Object(p.jsx)("h5",{className:"beep-client-text",children:"Bienvenue"}),y?Object(p.jsx)("button",{className:"btn-submit btn text",onClick:function(){h(!0)},children:"Consulter beep"}):Object(p.jsx)(S,{setBeepToken:k,setShowBepp:h,restaurantId:e}),Object(p.jsx)("button",{className:"btn-submit btn text",children:Object(p.jsx)(s.b,{to:"/restaurant/Menu/${restauranId}",children:Object(p.jsx)("span",{children:"Voir la carte"})})}),Object(p.jsx)("button",{className:"btn-submit btn text",children:"Mes points fid\xe9lit\xe9"})]})}),O&&d&&Object(p.jsxs)("div",{className:"beep-client-container2",children:[Object(p.jsx)("div",{className:"btn-back-container",children:Object(p.jsx)("div",{className:"",onClick:function(){h(!1)},children:Object(p.jsx)("img",{alt:"loading",src:"../../img/arrow.png"})})}),Object(p.jsx)(A,{beep:d})]})]})}),C=(n(138),n(26));n(144);C.c.GlobalWorkerOptions.workerSrc="//cdnjs.cloudflare.com/ajax/libs/pdf.js/".concat(C.c.version,"/pdf.worker.js");var T=function(){var e=JSON.parse(localStorage.getItem("user"))._id,t=Object(a.useState)(""),n=Object(l.a)(t,2),c=n[0],r=n[1];Object(a.useEffect)((function(){var e=JSON.parse(localStorage.getItem("user")).imageMenu;r(e?"".concat(e):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=")}),[]);var i=Object(a.useState)(null),s=Object(l.a)(i,2),o=(s[0],s[1]),u=Object(a.useState)(!1),d=Object(l.a)(u,2),b=(d[0],d[1]),j=Object(a.useState)(localStorage.getItem("beepToken")||null),m=Object(l.a)(j,2),O=m[0],h=m[1],v=Object(a.useRef)();window.OneSignal=window.OneSignal||[];var w=window.OneSignal;Object(a.useEffect)((function(){w.push((function(){w.init({appId:"0426b732-d4b7-47ed-9e66-48e7350b1749",safari_web_id:"web.onesignal.auto.3b9e77c1-5852-4edd-a278-c29c156a72b0",notifyButton:{enable:!0},welcomeNotification:{title:"One Signal",message:"Thanks for subscribing!"}})}))}),[]),Object(a.useEffect)((function(){A(),v.current&&v.current.offAny(),O&&(v.current=P()("/"),v.current.emit("auth",{beepToken:O}),v.current.on("auth",(function(e){e.success?(o(e.beep),b(!0)):(h(null),localStorage.removeItem("beepToken"))})),v.current.on("getUpdate",(function(e){var t=e.beep;switch(e.change){case"delete":localStorage.removeItem("beepToken"),o(null),h(null),b(!1);break;case"call":console.log("test"),o(t);break;default:o(t)}})))}),[O]);var A=function(){var t=Object(g.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x()({url:"/api/restaurant/".concat(e),method:"GET",headers:{"Content-Type":"application/json"}}).then(function(){var e=Object(g.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.data&&r(t.data.data[0].imageMenu);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),y=Object(a.useState)(1),S=Object(l.a)(y,2),k=S[0],N=(S[1],Object(a.useState)(null)),R=Object(l.a)(N,2),I=(R[0],R[1]),T=Object(a.useState)(1),z=Object(l.a)(T,2),E=z[0],q=(z[1],Object(a.useState)(!0)),M=Object(l.a)(q,2),B=(M[0],M[1]);return Object(p.jsx)("div",{className:"beep-client-container2",children:Object(p.jsx)("section",{id:"pdf-section",className:"beep-client-container2",children:Object(p.jsx)(C.a,{file:"/api/restaurant/servepdf/"+c,onLoadSuccess:function(e){var t=e.numPages;I(t),B(!1)},children:Object(p.jsx)(C.b,{pageNumber:E,scale:k})})})})},z=Object(a.lazy)((function(){return n.e(14).then(n.bind(null,184))})),E=Object(a.lazy)((function(){return n.e(8).then(n.bind(null,185))})),q=Object(a.lazy)((function(){return n.e(5).then(n.bind(null,186))})),M=Object(a.lazy)((function(){return n.e(21).then(n.bind(null,187))})),B=Object(a.lazy)((function(){return n.e(12).then(n.bind(null,188))})),L=Object(a.lazy)((function(){return n.e(10).then(n.bind(null,189))})),H=Object(a.lazy)((function(){return n.e(9).then(n.bind(null,190))})),U=Object(a.lazy)((function(){return n.e(13).then(n.bind(null,191))})),V=Object(a.lazy)((function(){return n.e(7).then(n.bind(null,192))})),_=Object(a.lazy)((function(){return n.e(16).then(n.bind(null,193))})),G=Object(a.lazy)((function(){return n.e(17).then(n.bind(null,194))})),J=Object(a.lazy)((function(){return n.e(15).then(n.bind(null,195))})),F=Object(a.lazy)((function(){return Promise.all([n.e(3),n.e(19)]).then(n.bind(null,196))})),Q=Object(a.lazy)((function(){return n.e(11).then(n.bind(null,197))})),Y=Object(a.lazy)((function(){return n.e(18).then(n.bind(null,198))})),K=Object(a.lazy)((function(){return Promise.all([n.e(6),n.e(4)]).then(n.bind(null,200))})),W=Object(a.lazy)((function(){return n.e(20).then(n.bind(null,199))}));function $(){return window.OneSignal=window.OneSignal||[],Object(p.jsx)(s.a,{children:Object(p.jsx)(a.Suspense,{fallback:Object(p.jsx)("div",{className:"container-loader",children:Object(p.jsx)("div",{className:"loader"})}),children:Object(p.jsxs)(o.d,{children:[Object(p.jsx)(m,{path:"/",exact:!0,component:B,restricted:!0}),Object(p.jsx)(m,{path:b.a.superAdminLoginPage,exact:!0,component:z,restricted:!0}),Object(p.jsx)(w,{path:b.a.superAdminHomePage,exact:!0,component:E,requiredRole:"superAdmin"}),Object(p.jsx)(w,{path:b.a.superAdminRestaurantsPage,exact:!0,component:q,requiredRole:"superAdmin"}),Object(p.jsx)(w,{path:b.a.superAdminManagePage,exact:!0,component:M,requiredRole:"superAdmin"}),Object(p.jsx)(m,{path:b.a.adminRegisterPage,exact:!0,component:B,restricted:!0,type:"register"}),Object(p.jsx)(m,{path:b.a.adminRegisterProPage,exact:!0,component:B,restricted:!0,type:"pro"}),Object(p.jsx)(m,{path:b.a.adminLoginPage,exact:!0,component:L,restricted:!0}),Object(p.jsx)(m,{path:b.a.adminForgotPassword,exact:!0,component:H,restricted:!0}),Object(p.jsx)(m,{path:b.a.adminResetPassword,exact:!0,component:U,restricted:!0}),Object(p.jsx)(m,{path:b.a.ClientRoute,exact:!0,component:I,restricted:!0}),Object(p.jsx)(m,{path:b.a.ClientMenu,exact:!0,component:T,restricted:!0}),Object(p.jsx)(w,{path:b.a.adminHomePage,exact:!0,component:V,requiredRole:"admin"}),Object(p.jsx)(w,{path:b.a.adminMenuPage,exact:!0,component:J,requiredRole:"admin"}),Object(p.jsx)(w,{path:b.a.adminAccountPage,exact:!0,component:_,requiredRole:"admin"}),Object(p.jsx)(w,{path:b.a.adminLogoPage,exact:!0,component:G,requiredRole:"admin"}),Object(p.jsx)(w,{path:b.a.adminConfidentialityPage,exact:!0,component:Q,requiredRole:"admin"}),Object(p.jsx)(w,{path:b.a.adminPaymentPage,exact:!0,component:Y,requiredRole:"admin"}),Object(p.jsx)(w,{path:b.a.adminQRCode,exact:!0,component:F,requiredRole:"admin"}),Object(p.jsx)(w,{path:b.a.adminBeeps,component:K,requiredRole:"admin"}),Object(p.jsx)(o.b,{path:"*",component:W})]})})})}i.a.render(Object(p.jsx)(c.a.StrictMode,{children:Object(p.jsx)($,{})}),document.getElementById("root"))},29:function(e,t,n){"use strict";t.a={ClientRoute:"/restaurant/beep/:restaurantId",ClientMenu:"/restaurant/Menu/:restauranId"}},42:function(e,t,n){"use strict";t.a={adminRegisterPage:"/register",adminRegisterProPage:"/register/pro",adminLoginPage:"/login",adminForgotPassword:"/forgot-password",adminResetPassword:"/reset-password/:token",adminHomePage:"/restaurant/admin",adminAccountPage:"/restaurant/parameter/account",adminMenuPage:"/restaurant/admin/Menu",adminLogoPage:"/restaurant/parameter/logo",adminBeeps:"/restaurant/admin/beeps",adminConfidentialityPage:"/restaurant/parameter/confidentiality",adminQRCode:"/restaurant/parameter/QRCode",adminPaymentPage:"/restaurant/parameter/payment"}},44:function(e,t,n){"use strict";t.a={superAdminLoginPage:"/superAdmin/login",superAdminHomePage:"/superAdmin",superAdminRestaurantsPage:"/superAdmin/restaurants",superAdminManagePage:"/superAdmin/manage"}},5:function(e,t,n){"use strict";var a=n(13),c=n(42),r=n(44),i=n(29),s=Object(a.a)(Object(a.a)(Object(a.a)({},r.a),c.a),i.a);t.a=s},59:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return u}));var a=n(4),c=n.n(a),r=n(8),i=n(20),s=n.n(i),o=function(){var e=Object(r.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(r.a)(c.a.mark((function e(n,a){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s()({url:"/api/beeps",method:"get",headers:{Authorization:"auth-token:".concat(t),"Content-Type":"application/json"}}).then(function(){var e=Object(r.a)(c.a.mark((function e(t){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.data.beeps,n(a);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){var t;a(null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.message,e.message)}));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=function(){var e=Object(r.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(r.a)(c.a.mark((function e(n,a){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.post("/api/beeps/generate",{restaurantId:t}).then((function(e){e.data.success||a(e.data.message),n(e.data.token)})).catch((function(e){return a(e.message)}));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},73:function(e,t){},82:function(e,t,n){}},[[145,1,2]]]);
//# sourceMappingURL=main.c0f8493d.chunk.js.map